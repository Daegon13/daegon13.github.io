---
// Página dinámica: renderiza el contenido MDX según slug
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('proyectos');
  return posts.map((p) => ({ params: { slug: p.data.slug }, props: { proyecto: p } }));
}

const { proyecto } = Astro.props;
const { title, resumen, stack, sector, rol, fecha, problema, solucion, resultado, repoUrl, demoUrl, cover } = proyecto.data;
---
<BaseLayout title={title} description={resumen} image={cover}>
  <article class="py-12 prose prose-slate max-w-none">
    <header class="not-prose mb-6">
      <h1 class="text-3xl font-bold">{title}</h1>
      <p class="text-gray-600">{resumen}</p>
      <div class="mt-2 text-sm text-gray-500">{sector} · {rol} · {fecha}</div>
      <div class="mt-3 flex flex-wrap gap-2">
        {stack.map((s) => <span class="rounded bg-gray-100 px-2 py-0.5 text-xs">{s}</span>)}
      </div>
      <div class="mt-4 flex gap-3">
        {demoUrl && <a href={demoUrl} class="rounded border px-3 py-1.5 hover:border-brand">Demo</a>}
        {repoUrl && <a href={repoUrl} class="rounded border px-3 py-1.5 hover:border-brand">Repositorio</a>}
      </div>
    </header>

    <section>
      <h2>Contexto</h2>
      <p><strong>Problema:</strong> {problema}</p>
      <p><strong>Solución:</strong> {solucion}</p>
      {resultado && <p><strong>Resultado:</strong> {resultado}</p>}
    </section>

    {/* Contenido adicional del MDX (si lo hubiera) */}
    <div class="mt-8">
      <Content />
    </div>
  </article>
</BaseLayout>
